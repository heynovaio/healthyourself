<section class="how-it-works">
  <div class="wrapper">
		<div class="steps">
      {% if section.settings.title != blank %}
        <h2>{{ section.settings.title | escape }}</h2>
      {% endif %}
      <div class="col-3">
      	{% for block in section.blocks %}
      		{%- assign img_url = block.settings.stepImage | img_url: '1x1' | replace: '_1x1.', '_{width}x.' -%}

          <a class="inner-col" href="{{ block.settings.servicesUrl | escape }}">
            <div class="services-container">

            {% if block.settings.stepImage != blank %}
            <div class="img-container">
              <div class="icon-img">
                <img src="{{ block.settings.stepImage | img_url: '300x300' }}"
                   data-src="{{ img_url }}"
                   alt="test">
              </div>
            </div>
            {% endif %}
            {% if block.settings.subTitle != blank %}
              <span>{{ block.settings.subTitle | escape }}</span>
            {% endif %}
            <h3 class="text-heading">{{ block.settings.stepTitle | escape }}</h3>
            <p>{{ block.settings.stepCopy | escape }}</p>
            {% comment %}<div class="subtitle">{{ block.settings.stepText | escape }}</div>{% endcomment %}
            </div>
			    </a>
				{% endfor %}
	    </div>
	  </div>
    {% if section.settings.button_label != blank and section.settings.button_link != blank %}
      <a href="{{ section.settings.button_link }}" class="btn-primary">
        {{ section.settings.button_label | escape }}
      </a>
    {% endif %}
  </div>
</section>
{% schema %}
  {
    "name": "How it works",
    "max_blocks": 3,
    "settings": [
      {
        "type": "text",
        "id": "title",
        "label": "Title",
        "default": "Heading"
      },
      {
        "type": "text",
        "id": "button_label",
        "label": "Button label"
      },
      {
        "type": "url",
        "id": "button_link",
        "label": "Button link"
      }
    ],
    "blocks": [
      {
        "type": "text",
        "name": "Steps",
        "settings": [
          {
		        "type": "image_picker",
		        "id": "stepImage",
		        "label": "Step Graphic"
		      },
          {
            "type": "text",
            "id": "subTitle",
            "label": "Sub Title (ex:price)"
          },
          {
            "type": "text",
            "id": "stepTitle",
            "label": "Step Text",
            "default": "Text stuff"
          },
		      {
		        "type": "textarea",
		        "id": "stepCopy",
		        "label": "Step Text",
		        "default": "Text stuff"
		      },
          {
            "type": "url",
            "id": "servicesUrl",
            "label": "How-it-works URL"
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "How it works",
        "category": "Text"
      }
    ]
  }
{% endschema %}
